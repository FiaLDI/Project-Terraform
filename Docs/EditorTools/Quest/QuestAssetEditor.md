<html>
<body>
<!--StartFragment--><html><head></head><body><h1>Создание префаба <strong>QuestPoint</strong></h1>
<blockquote>
<p><strong>Цель:</strong><br>
Настроить и сохранить префаб <strong>QuestPoint</strong>, представляющий интерактивную точку выполнения квеста, интегрированную с <code inline="">QuestManager</code>, <code inline="">QuestUI</code> и системой <code inline="">QuestBehaviour</code>.</p>
</blockquote>
<hr>
<h2>Оглавление</h2>
<ol>
<li>
<p>Подготовка</p>
</li>
<li>
<p>Создание объекта</p>
</li>
<li>
<p>Настройка коллайдера</p>
</li>
<li>
<p>Привязка квеста</p>
</li>
<li>
<p>Поведение точки</p>
</li>
<li>
<p>Сохранение в префаб</p>
</li>
<li>
<p>Тестирование в сцене</p>
</li>
</ol>
<hr>
<h2> Подготовка</h2>
<p>Перед созданием точки убедись, что в проекте присутствуют следующие элементы:</p>

Компонент | Расположение | Назначение
-- | -- | --
QuestManager | Quest system (в сцене) | Управляет всеми квестами
QuestUI | Quest system/UI | Отображает активные и завершённые квесты
QuestPoint.cs | Scripts/Quests | Скрипт точки выполнения квеста
QuestAsset | Assets/Quests/... | Конфигурация конкретного квеста
QuestBehaviour | Assets/Quests/Behaviours | Поведение цели (напр. подойти к точке)


<blockquote>
<p> <code inline="">QuestPoint</code> автоматически вызывает метод <code inline="">RegisterGoal(this)</code> в <code inline="">QuestManager</code>,<br>
что добавляет цель в активный квест при старте.</p>
</blockquote>



## Создание объекта

1. В **Hierarchy** нажми **Create Empty**
2. Переименуй объект в

   ```
   QuestPoint
   ```
3. В инспекторе добавь компонент:

   ```
   Add Component → QuestPoint
   ```

Скрипт `QuestPoint` автоматически добавит **SphereCollider** (требуется атрибутом `[RequireComponent(typeof(SphereCollider))]`).

---

##  Настройка коллайдера

В компоненте **SphereCollider**:

| Параметр       | Значение             | Описание                   |
| -------------- | -------------------- | -------------------------- |
| **Is Trigger** |  Включено           | Делает коллайдер триггером |
| **Radius**     | `2.0` (по умолчанию) | Радиус активации точки     |

>  **Совет:**
> Радиус можно подбирать в зависимости от размера сцены и требуемой точности.
> Например, для маленьких зон — 1.5, для открытых полей — до 4.0.

---

## Привязка квеста

1. В инспекторе `QuestPoint` найди поле:

   ```
   Linked Quest
   ```
2. Перетащи сюда объект `QuestAsset` (например):

   ```
   Assets/Quests/ApproachPoint/Configs/Q_Approach_Test.asset
   ```

Теперь `QuestPoint` знает, какой квест он представляет и автоматически зарегистрирует цель при запуске сцены.

---

## Поведение точки

При старте сцены `QuestPoint` создаёт экземпляр поведения, указанного в `QuestAsset`.

### Основные типы `QuestBehaviour`

| Поведение          | Скрипт                        | Логика                                                                         | Тип цели       |
| ------------------ | ----------------------------- | ------------------------------------------------------------------------------ | -------------- |
| **Approach Point** | `ApproachPointQuestBehaviour` | Завершает цель, когда игрок подошёл на нужное расстояние (`requiredDistance`). | Простая точка  |
| **Stand on Point** | `StandOnPointQuestBehaviour`  | Игрок должен простоять на точке заданное время (`requiredStayTime`).           | Задержка       |
| **Interact**       | `InteractQuestBehaviour`      | Завершение после нажатия клавиши `E` рядом с объектом.                         | Взаимодействие |

> `QuestPoint` автоматически вызывает метод `RegisterGoal(this)` в `QuestManager`,
> что добавляет цель в активный квест при старте.

---

## Сохранение в префаб

1. В **Hierarchy** выдели объект `QuestPoint`.
2. Перетащи его в проект в папку:

   ```
   Assets/Quests/ApproachPoint/Prefabs/
   ```
3. Unity создаст файл:

   ```
   QuestPoint.prefab
   ```

Теперь префаб можно дублировать, размещать на любых сценах и просто менять параметр **Linked Quest**.

---

## Тестирование в сцене

1. Запусти сцену (`Play`).
2. В консоли Unity должны появиться сообщения:

   ```
   Новая цель зарегистрирована в квесте 'Test Quest'. Всего целей: 1
   ```
3. После выполнения условий квеста (например, игрок подошёл к точке):

   ```
   Цель квеста 'Test Quest' выполнена (1/1)
   ```
4. На экране появится уведомление через `QuestUI`:

   ```
   Завершён квест: Test Quest
   ```

---
