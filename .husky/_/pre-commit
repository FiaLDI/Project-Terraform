#!/usr/bin/env sh
set -e

# Переход в корень проекта
ROOT_DIR="$(git rev-parse --show-toplevel)"
cd "$ROOT_DIR"

echo "------------------------------------------------------"
echo "▶ Pre-commit checks started"
echo "------------------------------------------------------"

### ---------------------------------------------------------
### Unity Meta checks
### ---------------------------------------------------------

if [ -f "./hooks/pre-commit/check-meta.sh" ]; then
    echo "▶ Checking missing .meta files..."
    ./hooks/check-meta.sh
else
    echo "⚠ check-meta.sh not found. SKIPPING meta check."
fi

### ---------------------------------------------------------
### Large file checks
### ---------------------------------------------------------

if [ -f "./hooks/pre-commit/check-large-files.sh" ]; then
    echo "▶ Checking for large files..."
    ./hooks/check-large-files.sh
else
    echo "⚠ check-large-files.sh not found. SKIPPING large-file check."
fi

### ---------------------------------------------------------
### Merge conflict markers
### ---------------------------------------------------------

if [ -f "./hooks/pre-commit/check-conflicts.sh" ]; then
    echo "▶ Checking for merge conflicts..."
    ./hooks/check-conflicts.sh
else
    echo "⚠ check-conflicts.sh not found. SKIPPING conflict check."
fi

echo "✅ Pre-commit checks finished successfully!"
echo "------------------------------------------------------"
